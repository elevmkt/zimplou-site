---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

// Get all blog posts
const posts = await Astro.glob('./*.mdx');
const sortedPosts = posts
  .filter(post => post.frontmatter.published !== false)
  .sort((a, b) => new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime());
---

<Layout 
  title="Blog | Zimplou"
  description="Dicas, novidades e insights sobre automação de agendamentos para pequenos negócios."
>
  <Header />
  
  <main class="py-16 sm:py-24">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <div class="text-center">
        <h1 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">
          Blog
        </h1>
        <p class="mt-4 text-lg text-slate-600">
          Dicas e insights sobre automação de agendamentos
        </p>
      </div>

      <!-- Posts grid -->
      <div class="mt-16 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {sortedPosts.length > 0 ? (
          sortedPosts.map((post) => (
            <a 
              href={post.url} 
              class="group rounded-2xl bg-white p-6 shadow-sm transition hover:shadow-lg hover:-translate-y-1"
            >
              <time class="text-sm text-slate-500">
                {new Date(post.frontmatter.pubDate).toLocaleDateString('pt-BR', { 
                  year: 'numeric', 
                  month: 'long', 
                  day: 'numeric' 
                })}
              </time>
              <h2 class="mt-3 text-xl font-semibold text-slate-900 group-hover:text-emerald-600 transition">
                {post.frontmatter.title}
              </h2>
              <p class="mt-2 text-slate-600 line-clamp-3">
                {post.frontmatter.description}
              </p>
              <span class="mt-4 inline-flex items-center gap-1 text-sm font-medium text-emerald-600">
                Ler mais
                <svg class="h-4 w-4 transition group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                </svg>
              </span>
            </a>
          ))
        ) : (
          <div class="col-span-full text-center py-12">
            <p class="text-slate-500">Nenhum post ainda. Volte em breve!</p>
          </div>
        )}
      </div>
    </div>
  </main>

  <Footer />
</Layout>
